# Функциональные требования  
_Артефакт: Шаг 2.1 — Функциональные требования к системе_  
_Связанные документы:_  
- [02a_requirements_structure.md](./02a_requirements_structure.md) — структура требований  
- [01_goal.md](./01_goal.md) — цель проекта  
- [00a_engineering_steps.md](./00a_engineering_steps.md) — инженерные шаги  

---

## 1. Основное поведение системы

1.1. Система должна реализовывать **отправку сообщения**, заданного отправителем, посредством вызова метода `Send` у объекта мессенджера.  

1.2. Метод `Send` должен быть реализован в классе мессенджера, который соответствует интерфейсу `IMessenger`.  

1.3. Корректным результатом работы метода считается **фиксация сообщения отправителя** в соответствии с конкретной реализацией мессенджера, без изменения поведения других мессенджеров.

---

## 2. Варианты реализации мессенджера

2.1. Система должна поддерживать и обеспечивать ортогональное использование следующих вариантов реализации интерфейса `IMessenger`:

- **Консольный мессенджер:** выводит сообщение в консоль.
- **Мессенджер-заглушка:** хранит переданное сообщение без вывода (для тестирования).
- **Мессенджер записи в файл (.txt):** записывает сообщение в заранее определённый файл `test.txt`.
- **Защищённый мессенджер:** реализует обёртку вокруг другого мессенджера, добавляя авторизацию через Microsoft Authentication, без расширения функционала под Linux и с минимальным набором возможностей (по аналогии с примером из книги).

2.2. Для создания защищённого мессенджера должна использоваться композиция — конструктор принимает другую реализацию `IMessenger`, что обеспечивает расширяемость без модификации существующих классов.

---

## 3. Пользовательский интерфейс и сценарий работы

3.1. При запуске программа должна вывести приветствие с описанием вариантов выбора мессенджера.  

3.2. После приветствия программа предлагает пользователю:  
- Ввести вариант мессенджера (выбор из доступных реализаций),  
- Ввести строку для отправки.

3.3. После ввода происходит:  
- Запуск тестов (описание и сценарии тестирования см. в разделе тестируемости),  
- Информирование пользователя о результате прохождения тестов.

3.4. В случае успешного прохождения тестов программа выводит в консоль информацию об использованном мессенджере.  

3.5. Если выбран мессенджер с внешним выводом (консольный или файл), вывод должен **соответствовать введённой строке**.

---

## 4. Тестирование (технические детали)

4.1. Используется фреймворк xUnit для реализации юнит-тестов.  

4.2. Тесты запускаются программно в два этапа:  
- Перед пользовательским вводом,  
- После пользовательского ввода.

4.3. Информация о каждом тесте (название и результат) выводится в консоль.

4.4. При неудаче любого теста программа информирует об этом и завершает выполнение.

4.5. В процессе разработки должна поддерживаться возможность запуска тестов без завершения работы программы для корректной реализации подхода TDD.

4.6. Для проверки корректности работы файлового мессенджера реализована верификация: чтение содержимого файла `test.txt` и сравнение с введённой строкой.

---

## 5. Принципиальные архитектурные моменты

5.1. Ортогональность и слабая связность обеспечиваются через чёткое определение интерфейса `IMessenger` и внедрение зависимостей (Dependency Injection).  

5.2. Все реализации должны соблюдаться без взаимных изменений и при этом быть взаимозаменяемыми.

---

## 6. Исключения и оговорки

- Описание интерфейса и механизмов выбора конкретной реализации мессенджера **не приводится здесь** в соответствии с решением см. раздела сценариев (4-й пункт структуры требований).  
- Детали тестирования, расширяемости и документации вынесены в соответствующие разделы (см. тестируемость и документируемость).  
- Верификация результата детально описана в сценариях.

---

## Итог

Этот документ содержит исчерпывающее и при этом сфокусированное описание **функциональных требований**, ограниченных только поведением системы и конкретными вариантами реализации. Это обеспечивает:

- Чёткость,  
- Простоту поддержки и масштабирования,  
- Лёгкую трассируемость к другим артефактам и требованиям.  

---
