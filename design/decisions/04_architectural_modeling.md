# Архитектурное моделирование

## Назначение
Цель архитектурного моделирования — понять систему как совокупность взаимодействующих ролей и уровней, связывающих слои и требования в проекте. Архитектура должна обеспечить гибкость и масштабируемость системы, а также обеспечить чёткое разделение обязанностей между компонентами.

## Слоистая модель

### 1. Слой Дизайна
**Ответственность**: Предоставление требований к поведению программы и критериев их выполнения. Этот слой включает в себя описание требований, которые затем преобразуются в абстракции, реализуемые в следующих слоях.

**Модуль**: `design/decisions/02c_nonfunctional.md`

---

### 2. Слой абстракций
**Ответственность**: Поддержка контракта между слоем исполнителей и слоем координатора. Обеспечивает изоляцию реализации от остальной системы, позволяя легко менять реализацию без изменений в других слоях.

**Модуль**: Интерфейс `IMessenger`

---

### 3. Входной слой
**Ответственность**: Принятие входных параметров и выполнение сценария программы. Этот слой взаимодействует с пользователем и передает данные координатору. Также здесь происходит инициализация зависимостей через DI.

**Класс**: `Program.cs`

---

### 4. Слой координатора
**Ответственность**: Сбор и передача входных данных исполнителям. Обеспечивает изоляцию слоя исполнителей от внешних зависимостей через взаимодействие по контракту. Управляет жизненным циклом компонентов и их взаимодействием.

**Класс**: `Sender.cs`

---

### 5. Слой исполнителей
**Ответственность**: Обработка входных данных и передача результата. Каждый исполнитель реализует свою специфику обработки, но всегда соответствует контракту, заданному интерфейсом `IMessenger`.

**Классы**: `ConsoleMessenger.cs`, `StubMessenger.cs`, `FileMessenger.cs`, `SecureMessenger.cs`

---

### 6. Слой тестирования
**Ответственность**: Проверка соответствия выполнения требований, заданных в слое дизайна, с фактическим поведением исполнителей и координаторов. Тесты обеспечивают, что контракт между компонентами не нарушен и все элементы взаимодействуют корректно.

**Класс**: `TestSender.cs`

## Абстракции и зависимости

### Ключевые абстракции
- **Документация**: Описания требований и критериев выполнения.
- **Интерфейс `IMessenger`**: Контракт для всех исполнителей, обеспечивающий их совместимость с координатором.

### Служебные классы
- **Program**: Зависит от `IMessenger`, его реализаций, а также от `Sender` и документации.
- **Sender**: Зависит от `IMessenger` (точка инверсии зависимостей).
- **Тесты**: Зависит от конкретных реализаций классов исполнителей и координатора, а также от документации.

### Реализации
- **ConsoleMessenger**, **StubMessenger**, **FileMessenger**, **SecureMessenger**: Реализуют интерфейс `IMessenger` и зависят от него.
- **Sender**: Зависит от интерфейса `IMessenger` (точка инверсии зависимостей).

## DI как инфраструктура

Связывание абстракций и реализаций происходит вручную во входном слое (`Program.cs`). Этот подход позволяет изолировать координатор от исполнителей и реализовывать/модифицировать исполнителей независимо от координатора. Использование DI способствует слабой связанности компонентов и улучшает масштабируемость системы.

## Поведение и расширяемость

Для расширения функционала системы необходимо:
- Выделить абстракцию координатора для возможности добавления различных вариантов координаторов.
- Добавить новые исполнители в слой исполнителей.
- Внесение изменений в зависимость между точкой входа и координатором.
- Возможность выделения обработчика входных данных в отдельную абстракцию, что позволит снизить неявные зависимости в точке входа.

Изменения в одном слое должны минимально влиять на остальные слои, что делает систему легко расширяемой и поддерживаемой.

## Тесты как архитектурная часть

Тесты являются неотъемлемой частью архитектуры и выполняют следующие задачи:
- Проверяют выполнение контрактов и соответствие поведения исполнителей и координаторов требованиям документации.
- Обеспечивают корректность взаимодействия компонентов.
- Планируются юнит-тесты, которые проверяют инварианты и корректность работы зависимостей, что позволяет гарантировать стабильность системы при изменениях.

Тесты обеспечивают непрерывную проверку корректности работы системы, подтверждая её работоспособность и соответствие требованиям.

---

**Примечание**: Данная архитектурная модель закладывает основы для разработки и тестирования системы, способной легко адаптироваться к изменениям и масштабироваться.
